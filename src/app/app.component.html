<section style="position: fixed;
top: 0;
z-index: 100;
width: 100%;">
  <header class="header">
    <div class="header-align">
      <svg xmlns="http://www.w3.org/2000/svg" width="42" height="42" viewBox="0 0 24 24">
        <path fill="currentColor" fill-rule="evenodd"
          d="M10.847 21.934C5.867 21.362 2 17.133 2 12C2 6.477 6.477 2 12 2s10 4.477 10 10c0 5.157-3.283 4.733-6.086 4.37c-1.618-.209-3.075-.397-3.652.518c-.395.626.032 1.406.555 1.929a1.673 1.673 0 0 1 0 2.366c-.523.523-1.235.836-1.97.751M11.085 7a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0M6.5 13a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m11 0a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3m-3-4.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3"
          clip-rule="evenodd" />
      </svg>
      <h1>Boot Theme Json Generator</h1>
    </div>
    <div style="display: flex; gap: 1em;">
      <button (click)="addTheme()" class="wavy-button">Export Json</button>
      <button (click)="getFinalModel()" class="wavy-button">Save Changes</button>
    </div>
  </header>
</section>
<div class="body-definer">
  <section style="width: 33%;">
    <app-theme-management (themeProperties)=newProperty($event)></app-theme-management>
  </section>
  <section style="width: 67%; position: relative; top: 10vh;" *ngIf="themes.length < 1; else themeTemplate">
    <div class="empty-state">
      <img src="assets/images/bwink_edu_09_single_06.jpg" alt="No Themes" class="empty-image">
      <h2>No Themes Yet ðŸŽ¨</h2>
      <p>Create and customize your own theme. Start by clicking the button below.</p>
      <button (click)="addTheme()" class="wavy-button">Add New Theme</button>
    </div>
  </section>

  <ng-template #themeTemplate>
    <section style="width: 67%; position: relative; top: 10vh;">
      <div class="theme-body mat-elevation-z2">
        <button mat-raised-button color="primary" class="wavy-button m-1" (click)="addTheme()">+ Add Theme</button>

        <mat-accordion>
          <mat-expansion-panel *ngFor="let theme of themes; let i = index" [expanded]="theme.expanded"
            (opened)="toggleAccordion(theme, i)" (closed)="theme.expanded = false"
            [disabled]="!theme.themeName || theme.themeName.trim().length === 0">
            <mat-expansion-panel-header>
              <mat-form-field appearance="outline">
                <mat-label>Theme Name</mat-label>
                <input matInput [(ngModel)]="theme.themeName" placeholder="Enter theme name"
                  (input)="validateTheme(theme)">
              </mat-form-field>
              <button mat-icon-button color="warn" (click)="removeTheme(i); $event.stopPropagation();">
                <mat-icon>delete</mat-icon>
              </button>
            </mat-expansion-panel-header>

            <div>
              <!-- Check that theme.values exists and has properties -->
              <div *ngIf="properties.length > 0; else noProperties">
                <div *ngFor="let prop of theme.values" class="property-item">
                  <label>{{ prop.keyName }}</label>

                  <!-- Dropdown for selecting SubType -->
                  <mat-form-field appearance="outline" class="input-field" *ngIf="prop.type.trim() === 'Colors' || prop.type.trim() === 'Spacing & Sizing'">
                    <mat-label>Sub Type</mat-label>
                    <mat-select [(ngModel)]="prop.subType" (selectionChange)="updateProperty(theme, prop)">
                      <ng-container *ngIf="prop.type.trim() === 'Colors'">
                        <mat-option value="background-color">Background Color</mat-option>
                        <mat-option value="color">Text Color</mat-option>
                        <mat-option value="border-color">Border Color</mat-option>
                      </ng-container>
                      <ng-container *ngIf="prop.type.trim() === 'Spacing & Sizing'">
                        <mat-option value="width">Width</mat-option>
                        <mat-option value="height">Height</mat-option>
                        <mat-option value="padding">Padding</mat-option>
                        <mat-option value="margin">Margin</mat-option>
                        <mat-option value="border-radius">Border Radius</mat-option>
                        <mat-option value="font-size">Font Size</mat-option>
                        <mat-option value="font-weight">Font Weight</mat-option>
                        <mat-option value="letter-spacing">Letter Spacing</mat-option>
                        <mat-option value="line-height">Line Height</mat-option>
                      </ng-container>
                    </mat-select>
                  </mat-form-field>

                  <!-- Colors: Use color picker -->
                  <input *ngIf="prop.type.trim() === 'Colors'" type="color" [(ngModel)]="prop.value"
                    (change)="updateProperty(theme, prop)">

                  <!-- Spacing & Sizing: Numeric input with unit selection -->
                  <div *ngIf="prop.type.trim() === 'Spacing & Sizing'" class="input-group">
                    <input type="number" [(ngModel)]="prop.numericValue" (change)="updateProperty(theme, prop)"
                      placeholder="0">
                    <select [(ngModel)]="prop.unit" (change)="updateProperty(theme, prop)">
                      <option value="px">px</option>
                      <option value="em">em</option>
                      <option value="rem">rem</option>
                      <option value="%">%</option>
                    </select>
                  </div>

                  <!-- Box Shadow: Grouped inputs -->
                  <div *ngIf="prop.type.trim() === 'Box Shadow'" class="box-shadow-settings">
                    <input type="number" [(ngModel)]="prop.shadowX" placeholder="X Offset (px)"
                      (change)="updateProperty(theme, prop)">
                    <input type="number" [(ngModel)]="prop.shadowY" placeholder="Y Offset (px)"
                      (change)="updateProperty(theme, prop)">
                    <input type="number" [(ngModel)]="prop.blur" placeholder="Blur (px)"
                      (change)="updateProperty(theme, prop)">
                    <input type="color" [(ngModel)]="prop.shadowColor" (change)="updateProperty(theme, prop)">
                  </div>

                  <!-- Borders & Outlines: Border controls -->
                  <div *ngIf="prop.type.trim() === 'Borders & Outlines'" class="input-group">
                    <div class="input-field">
                      <input matInput type="number" [(ngModel)]="prop.borderWidth" placeholder="Border Width"
                        (change)="updateProperty(theme, prop)">
                    </div>

                    <!-- Unit Selection -->
                    <mat-form-field appearance="outline" class="input-field">
                      <mat-label>Unit</mat-label>
                      <mat-select [(ngModel)]="prop.unit" (selectionChange)="updateProperty(theme, prop)">
                        <mat-option selected value="px">px</mat-option>
                        <mat-option value="em">em</mat-option>
                        <mat-option value="rem">rem</mat-option>
                        <mat-option value="%">%</mat-option>
                      </mat-select>
                    </mat-form-field>

                    <!-- Stroke Type (Border Style) -->
                    <mat-form-field appearance="outline" class="input-field">
                      <mat-label>Stroke Type</mat-label>
                      <mat-select [(ngModel)]="prop.borderStyle" (selectionChange)="updateProperty(theme, prop)">
                        <mat-option value="solid">Solid</mat-option>
                        <mat-option value="dashed">Dashed</mat-option>
                        <mat-option value="dotted">Dotted</mat-option>
                      </mat-select>
                    </mat-form-field>

                    <!-- Border Color Picker -->
                    <div class="input-field">
                      <input matInput type="color" [(ngModel)]="prop.borderColor"
                        (change)="updateProperty(theme, prop)">
                    </div>
                  </div>

                  <!-- Animations: Animation controls -->
                  <div *ngIf="prop.type.trim() === 'Animations'" class="input-group">
                    <input type="text" [(ngModel)]="prop.animationName" placeholder="Animation Name"
                      (change)="updateProperty(theme, prop)">
                    <input type="number" [(ngModel)]="prop.animationDuration" placeholder="Duration (s)"
                      (change)="updateProperty(theme, prop)">
                  </div>

                  <!-- Box Shadow Preview -->
                  <div *ngIf="prop.type.trim() === 'Box Shadow'" class="shadow-preview"
                    [ngStyle]="{'box-shadow': getBoxShadow(prop)}">
                    Shadow Preview
                  </div>
                </div>
              </div>

              <ng-template #noProperties>
                <div class="empty-states">
                  <img src="assets/images/47041222.jpg" alt="No Properties" />
                  <h2>No properties added yet</h2>
                  <p>Start by adding a new property to customize your theme.</p>
                </div>
              </ng-template>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </div>
      <div class="copy-body" style="display: flex; margin-top: 15px;">
        <div class="json-container" *ngIf="ThemeCssJson">
          <div class="json-header">
            <span>Root Css Preview</span>
            <button (click)="copyToClipboard()" class="copy-btn">Copy JSON</button>
          </div>
          <pre><code>{{ ThemeCssJson }}</code></pre>
        </div>
        <div class="json-container" *ngIf="formattedJson.length > 0 && formattedJson">
          <div class="json-header">
            <span>Theme Model JSON </span>
            <button (click)="copyToClipboard()" class="copy-btn">Copy JSON</button>
          </div>
          <pre><code>{{ formattedJson }}</code></pre>
        </div>
      </div>